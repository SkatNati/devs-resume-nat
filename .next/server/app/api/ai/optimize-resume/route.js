"use strict";(()=>{var e={};e.id=4906,e.ids=[4906],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},87561:e=>{e.exports=require("node:fs")},84492:e=>{e.exports=require("node:stream")},71017:e=>{e.exports=require("path")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},71267:e=>{e.exports=require("worker_threads")},59796:e=>{e.exports=require("zlib")},34686:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>y,originalPathname:()=>S,patchFetch:()=>b,requestAsyncStorage:()=>c,routeModule:()=>m,serverHooks:()=>g,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>f});var s={};r.r(s),r.d(s,{POST:()=>d});var i=r(95419),a=r(69108),n=r(99678),o=r(29764),u=r(39697),l=r(78070);let d=async e=>{let t=await e.json(),r=t?.id;if(!r)return l.Z.json({message:"Invalid request"},{status:400});try{let e=await u.Z.findById(r);if(!e)return l.Z.json({message:"CV not found"},{status:404});if(e.isAiGenerate)return l.Z.json({message:"CV already generated by AI",data:e},{status:200});let t=await p(e?.optimizeResume[0]?.extractedCvText?.parsedText,e?.optimizeResume?.[0]?.jobDesc),s=JSON.parse(t),i={$set:{firstName:s?.firstName,lastName:s?.lastName,email:s?.email,linkedin:s?.linkedin,address:s?.address,phone:s?.phone,summary:s?.summary,education:s?.education,experience:s?.experience,skills:s?.skills,isAiGenerate:!0}},a=await u.Z.findByIdAndUpdate(r,i,{new:!0});if(!a)return l.Z.json({message:"Failed to update CV"},{status:500});return l.Z.json({message:"CV updated successfully with AI-generated content.",data:a},{status:200})}catch(e){return console.error("Error during CV update:",e),l.Z.json({message:"An error occurred",error:e.toString()},{status:500})}};async function p(e,t){let r=`
{
  "email": "Email address of the user.",
  "firstName": "First name of the user.",
  "lastName": "Last name of the user.",
  "linkedin": "URL to the user's LinkedIn profile.",
  "summary": "Professional summary of the user.",
  "skills": [
    {
      "label": "Example skill label, e.g., 'Web Design'.",
      "selected": true
    }
  ],
  "education": [
    {
      "institutionName": "Example institution, e.g., 'MIT'.",
      "degreeName": "Degree obtained, e.g., 'BSc in Computer Science'.",
      "fieldOfStudy": "Field of study, e.g., 'Computer Science'.",
      "graduationYear": "Year of graduation, e.g., '2024'.",
      "currentlyStudying": false
    }
  ],
  "experience": [
    {
      "companyName": "Example company name, e.g., 'Google'.",
      "startDate": "Start date of the experience, e.g., 'January 2020'.",
      "endDate": "End date or 'Present' if currently working.",
      "currentlyWorking": true,
      "jobTitle": "Job position, e.g., 'Senior Web Developer'.",
      "responsibilities": "HTML-formatted description of job responsibilities.",
      "achievements": "Notable achievements, e.g., 'Developed a key software solution.'"
    }
  ]
}
`,s=[{role:"system",content:`
      # Role Prompting
      You are a highly skilled resume optimizer with a special ability to enhance users’ resumes for a specific job by analyzing the job description.

      # Task
      Optimize an existing resume by highlighting or adding important keywords to cater to the target job description. Use a chain of thought to think step by step, ensuring the resume is tailored to the job description provided. First, analyze the job description and the user’s resume. Then highlight the user’s strengths in relation to the job description’s requirements.

      # Specific
      This task is essential for our service. Do not send any response other than the final product.

      # Context
      You are operating in a professional SaaS business environment with no room for error. Reiterate your role and maintain a high level of professionalism. The output should be structured as a JSON object with these keys: ${r}

      # Examples
      User Input (Complete):
      Existing Resume: Has complete information about the user.
      Job Description: Complete job description. Example: A role for Senior SharePoint Developer at ABC Corp.

      Expected Output:
      An optimized resume tailored to the Senior SharePoint Developer position at ABC Corp. and its qualification requirements, highlighting relevant experience and skills.

      # Notes
      Ensure the resume is optimized for the specific job description. Fill gaps with either the model's knowledge or placeholders. Do not send incomplete responses or error messages.
    `},{role:"user",content:`Here are the JSON details for generating the CV: ${e}. Tailor the resume to fit this job description: ${t}. also make sure to use the same information on the resume for the new one you are creating. please follow all the keys we have in here ${r} no mistake, also don't add the personalInformation key, the firstName, lastName linkedin, email should be added directly to the object `}];return(await o.Z.chat.completions.create({model:"gpt-4-turbo-preview",messages:s,max_tokens:1024,temperature:.7,response_format:{type:"json_object"}})).choices[0].message.content}let m=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/ai/optimize-resume/route",pathname:"/api/ai/optimize-resume",filename:"route",bundlePath:"app/api/ai/optimize-resume/route"},resolvedPagePath:"C:\\My Files\\Teneshu\\Talent\\Upwork\\Dev's Resume Finalizing\\Mine\\Dev-s-Resume-main\\app\\api\\ai\\optimize-resume\\route.js",nextConfigOutput:"",userland:s}),{requestAsyncStorage:c,staticGenerationAsyncStorage:h,serverHooks:g,headerHooks:y,staticGenerationBailout:f}=m,S="/api/ai/optimize-resume/route";function b(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:h})}},29764:(e,t,r)=>{r.d(t,{Z:()=>s});let s=new(r(72032)).ZP({apiKey:"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"})},39697:(e,t,r)=>{r.d(t,{Z:()=>a});let s=r(11185),i=new s.Schema({user:{type:s.Schema.Types.ObjectId,ref:"User",required:!0},firstName:{type:String},lastName:{type:String},jobTitle:{type:String},email:{type:String},linkedin:{type:String},address:{type:String},phone:{type:String},summary:{type:String},isComplete:{type:Boolean,default:!1},isAiGenerate:{type:Boolean,default:!1},templateId:{type:String,default:"Dev Resume 1"},skills:[{label:{type:String,required:!0},selected:{type:Boolean,default:!1}}],education:[{institutionName:{type:String,required:!0},degreeName:{type:String,required:!0},fieldOfStudy:{type:String,required:!0},graduationYear:{type:String,required:!0},currentlyStudying:{type:Boolean}}],experience:[{companyName:{type:String,required:!0},startDate:{type:String,required:!0},endDate:{type:String},currentlyWorking:{type:Boolean,default:!1},jobTitle:{type:String,required:!0},responsibilities:{type:String,required:!0},achievements:{type:String}}],optimizeResume:[{extractedCvText:{parsedText:String,fileName:String},jobDesc:{type:String,required:!0}}]},{timestamps:!0}),a=s.models.Resume||s.model("Resume",i)},87553:e=>{function t(e,t,r,s){return Math.round(e/r)+" "+s+(t>=1.5*r?"s":"")}e.exports=function(e,r){r=r||{};var s,i,a=typeof e;if("string"===a&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"weeks":case"week":case"w":return 6048e5*r;case"days":case"day":case"d":return 864e5*r;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*r;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*r;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}(e);if("number"===a&&isFinite(e))return r.long?(s=Math.abs(e))>=864e5?t(e,s,864e5,"day"):s>=36e5?t(e,s,36e5,"hour"):s>=6e4?t(e,s,6e4,"minute"):s>=1e3?t(e,s,1e3,"second"):e+" ms":(i=Math.abs(e))>=864e5?Math.round(e/864e5)+"d":i>=36e5?Math.round(e/36e5)+"h":i>=6e4?Math.round(e/6e4)+"m":i>=1e3?Math.round(e/1e3)+"s":e+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[1638,6206,2032],()=>r(34686));module.exports=s})();