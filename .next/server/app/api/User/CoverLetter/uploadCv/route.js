"use strict";(()=>{var e={};e.id=1984,e.ids=[1984],e.modules={11185:e=>{e.exports=require("mongoose")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},13358:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>g,originalPathname:()=>x,patchFetch:()=>w,requestAsyncStorage:()=>f,routeModule:()=>c,serverHooks:()=>y,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>v});var a={};r.r(a),r.d(a,{PATCH:()=>d,default:()=>l});var s=r(95419),n=r(69108),i=r(99678),o=r(74950),p=r(76520),u=r(31281);async function d(e){let t=await e.formData(),r=t.get("id"),a=t.get("resumePDF");try{let e;await (0,p.Z)();let t=await u.Z.findById(r);if(!t)return new Response(JSON.stringify({message:"Not Found"}),{status:404});if(t?.extractedCvText?.parsedText&&!a.type)return new Response(JSON.stringify({message:"..."}),{status:200});if(!a?.arrayBuffer)return new Response(JSON.stringify({message:"No files uploaded."}),{status:400});let s=Buffer.from(await a.arrayBuffer()),n=a.type;if("application/pdf"===n)e=await (0,o.b)(s);else{if("application/vnd.openxmlformats-officedocument.wordprocessingml.document"!==n&&"application/msword"!==n)return new Response(JSON.stringify({message:"Unsupported file type"}),{status:400});e=await (0,o.i)(s)}return await u.Z.findByIdAndUpdate(r,{$set:{"extractedCvText.parsedText":e,"extractedCvText.fileName":a.name}},{new:!0}),new Response(JSON.stringify({message:"Data updated successfully"}),{status:200})}catch(e){return console.error("Error in PDF handling: ",e),new Response(JSON.stringify({error:e.message}),{status:500})}}let l=d,c=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/User/CoverLetter/uploadCv/route",pathname:"/api/User/CoverLetter/uploadCv",filename:"route",bundlePath:"app/api/User/CoverLetter/uploadCv/route"},resolvedPagePath:"C:\\My Files\\Teneshu\\Talent\\Upwork\\Dev's Resume Finalizing\\Mine\\Dev-s-Resume-main\\app\\api\\User\\CoverLetter\\uploadCv\\route.js",nextConfigOutput:"",userland:a}),{requestAsyncStorage:f,staticGenerationAsyncStorage:m,serverHooks:y,headerHooks:g,staticGenerationBailout:v}=c,x="/api/User/CoverLetter/uploadCv/route";function w(){return(0,i.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:m})}},74950:(e,t,r)=>{r.d(t,{i:()=>o,b:()=>i});let a=require("pdf-parse");var s=r.n(a),n=r(99264);async function i(e){try{return(await s()(e)).text}catch(e){throw console.error("Error parsing PDF: ",e),Error("Failed to parse PDF")}}async function o(e){try{let{value:t}=await n.extractRawText({buffer:e});return t}catch(e){throw console.error("Error parsing DOCX: ",e),Error("Failed to parse DOCX")}}},76520:(e,t,r)=>{r.d(t,{Z:()=>n});var a=r(11185),s=r.n(a);let n=async()=>{try{await s().connect("mongodb+srv://Salahdin:WqN5xnY7Y2gdyWQ4@serverlessinstance0.jzng7nc.mongodb.net/dev's-resume")}catch(e){throw Error("connection failed")}}},31281:(e,t,r)=>{r.d(t,{Z:()=>n});let a=r(11185),s=new a.Schema({user:{type:a.Schema.Types.ObjectId,ref:"User",required:!0},firstName:{type:String},lastName:{type:String},jobTitle:{type:String},email:{type:String},linkedin:{type:String},address:{type:String},phone:{type:String},summary:{type:String},salutation:{type:String},isComplete:{type:Boolean,default:!1},isAiGenerate:{type:Boolean,default:!1},jobInfo:{companyName:{type:String},companyAddress:{type:String},companyCity:{type:String},jobDescription:{type:String}},extractedCvText:{parsedText:String,fileName:String},result:{type:String}},{timestamps:!0}),n=a.models.coverLetter||a.model("coverLetter",s)},95419:(e,t,r)=>{e.exports=r(30517)}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[1638,9264],()=>r(13358));module.exports=a})();